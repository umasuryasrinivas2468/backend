{"version":3,"names":["_reactNative","require","_package","_cashfreePgApiContract","_CFCardComponent","_interopRequireDefault","e","__esModule","default","_defineProperty","r","t","_toPropertyKey","Object","defineProperty","value","enumerable","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","LINKING_ERROR","Platform","select","ios","CashfreePgApi","NativeModules","Proxy","get","Error","CFPaymentGateway","constructor","emitter","OS","NativeEventEmitter","CashfreeEventEmitter","NativeAppEventEmitter","doPayment","checkoutPayment","version","JSON","stringify","doUPIPayment","doWebPayment","cfSession","doCardPayment","cardPayment","makePayment","getInstalledUpiApps","Promise","resolve","reject","fetchUpiList","apps","console","log","upiAppsSubscription","addListener","cfPayment","paymentData","CFUPIPayment","doElementUPIPayment","CFCardPayment","setEventSubscriber","cfEventCallback","eventFunction","event","data","parse","onReceivedEvent","eventName","meta","eventSubscription","removeEventSubscriber","undefined","remove","setCallback","cfCallback","successFunction","orderID","onVerify","failureFunction","error","response","CFErrorResponse","message","fromJSON","onError","successSubscription","failureSubscription","removeCallback","errorString","object","status","code","type","getStatus","getMessage","getCode","getType","exports","CFCard","CFCardComponent","CFPaymentGatewayService"],"sources":["index.js"],"sourcesContent":["import { NativeAppEventEmitter, NativeEventEmitter, NativeModules, Platform, } from 'react-native';\nimport { version } from '../package.json';\nimport { CFUPIPayment, CFCardPayment } from 'cashfree-pg-api-contract';\nimport CFCardComponent from './Card/CFCardComponent';\nconst LINKING_ERROR = `The package 'react-native-cashfree-pg-api' doesn't seem to be linked. Make sure: \\n\\n` +\n    Platform.select({ ios: '- You have run \\'pod install\\'\\n', default: '' }) +\n    '- You rebuilt the app after installing the package\\n' +\n    '- You are not using Expo managed workflow\\n';\nconst CashfreePgApi = NativeModules.CashfreePgApi\n    ? NativeModules.CashfreePgApi\n    : new Proxy({}, {\n        get() {\n            throw new Error(LINKING_ERROR);\n        },\n    });\nclass CFPaymentGateway {\n    emitter;\n    successSubscription = null;\n    failureSubscription = null;\n    eventSubscription = null;\n    upiAppsSubscription = null;\n    constructor() {\n        this.emitter =\n            Platform.OS === 'ios'\n                ? new NativeEventEmitter(NativeModules.CashfreeEventEmitter)\n                : NativeAppEventEmitter;\n    }\n    doPayment(checkoutPayment) {\n        checkoutPayment.version = version;\n        CashfreePgApi.doPayment(JSON.stringify(checkoutPayment));\n    }\n    doUPIPayment(checkoutPayment) {\n        checkoutPayment.version = version;\n        CashfreePgApi.doUPIPayment(JSON.stringify(checkoutPayment));\n    }\n    doWebPayment(cfSession) {\n        CashfreePgApi.doWebPayment(JSON.stringify(cfSession));\n    }\n    /**\n     * @deprecated : Instead call makePayment\n     */\n    doCardPayment(cardPayment) {\n        this.makePayment(cardPayment);\n    }\n    async getInstalledUpiApps() {\n        return new Promise((resolve, reject) => {\n            if (Platform.OS === 'ios') {\n                let fetchUpiList = (apps) => {\n                    console.log(JSON.stringify(apps));\n                    if (apps) {\n                        resolve(apps);\n                    }\n                    else {\n                        reject('No UPI apps found');\n                    }\n                };\n                this.upiAppsSubscription = this.emitter.addListener('cfUpiApps', fetchUpiList);\n                CashfreePgApi.getInstalledUpiApps();\n            }\n            else {\n                CashfreePgApi.getInstalledUpiApps((apps) => {\n                    if (apps) {\n                        resolve(apps);\n                    }\n                    else {\n                        reject('No UPI apps found');\n                    }\n                });\n            }\n        });\n    }\n    makePayment(cfPayment) {\n        cfPayment.version = version;\n        const paymentData = JSON.stringify(cfPayment);\n        if (cfPayment instanceof CFUPIPayment) {\n            CashfreePgApi.doElementUPIPayment(paymentData);\n        }\n        else if (cfPayment instanceof CFCardPayment) {\n            CashfreePgApi.doCardPayment(paymentData);\n        }\n        else {\n            console.log('makePayment::==> Wrong payment object');\n        }\n    }\n    setEventSubscriber(cfEventCallback) {\n        let eventFunction = (event) => {\n            console.log(JSON.stringify(event));\n            let data = JSON.parse(event);\n            cfEventCallback.onReceivedEvent(data.eventName, data.meta);\n        };\n        this.eventSubscription = this.emitter.addListener('cfEvent', eventFunction);\n        CashfreePgApi.setEventSubscriber();\n    }\n    removeEventSubscriber() {\n        if (this.eventSubscription !== undefined &&\n            this.eventSubscription !== null) {\n            this.eventSubscription.remove();\n            this.eventSubscription = null;\n        }\n        CashfreePgApi.removeEventSubscriber();\n    }\n    setCallback(cfCallback) {\n        // this.cfCallback = cfCallback;\n        let successFunction = (orderID) => {\n            console.log('response is : ' + JSON.stringify(orderID));\n            cfCallback.onVerify(orderID);\n        };\n        let failureFunction = (error) => {\n            console.log('reason: ' + JSON.stringify(error));\n            const response = new CFErrorResponse();\n            // @ts-ignore\n            const message = JSON.parse(error);\n            response.fromJSON(message.error);\n            // @ts-ignore\n            cfCallback.onError(response, message.orderID);\n        };\n        this.successSubscription = this.emitter.addListener('cfSuccess', successFunction);\n        this.failureSubscription = this.emitter.addListener('cfFailure', failureFunction);\n        CashfreePgApi.setCallback();\n    }\n    removeCallback() {\n        if (this.successSubscription !== undefined &&\n            this.successSubscription !== null) {\n            this.successSubscription.remove();\n            this.successSubscription = null;\n        }\n        if (this.failureSubscription !== undefined &&\n            this.failureSubscription !== null) {\n            this.failureSubscription.remove();\n            this.failureSubscription = null;\n        }\n        if (this.upiAppsSubscription !== undefined &&\n            this.upiAppsSubscription !== null) {\n            this.upiAppsSubscription.remove();\n            this.upiAppsSubscription = null;\n        }\n    }\n}\nexport class CFErrorResponse {\n    status = 'FAILED';\n    message = 'payment has failed';\n    code = 'payment_failed';\n    type = 'request_failed';\n    fromJSON(errorString) {\n        console.log('errorString :' + errorString);\n        const object = JSON.parse(errorString);\n        console.log('errorStringObject :' + object);\n        this.status = object.status;\n        this.message = object.message;\n        this.code = object.code;\n        this.type = object.type;\n    }\n    getStatus() {\n        return this.status;\n    }\n    getMessage() {\n        return this.message;\n    }\n    getCode() {\n        return this.code;\n    }\n    getType() {\n        return this.type;\n    }\n}\nexport const CFCard = CFCardComponent;\nexport const CFPaymentGatewayService = new CFPaymentGateway();\n"],"mappings":"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","ignoreList":[]}